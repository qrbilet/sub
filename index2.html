<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ–ø–ª–∞—Ç–µ</title>
    <base href=".">
    <link rel="icon" type="image/x-icon" href="./favicon.ico">
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico">

    <style>
        html, body {
            min-height: 100%;
            margin: 0;
            box-sizing: border-box;
            background-color: #f5f1e8;
            font-family: 'Circe', sans-serif;
        }

        @font-face {
            font-family: 'Circe';
            src: url(circe-bold-webfont.27529df664ce2f0e.woff2) format("woff2"),
                 url(circe-bold-webfont.a6d441f673662776.woff) format("woff");
            font-weight: 700;
        }

        @font-face {
            font-family: 'Circe';
            src: url(circe-regular-webfont.70e2ea4fb032224b.woff2) format("woff2"),
                 url(circe-regular-webfont.01fbe67cb561e424.woff) format("woff");
            font-weight: 400;
        }

        .logo {
            text-align: center;
            margin: 16px 0;
        }

        .content {
            padding: 0 16px;
        }

        .ticket {
            margin-top: 39px;
        }

        .ticket__qrcode {
            margin: 31px 0;
            text-align: center;
        }

        .ticket__button {
            margin-bottom: 32px;
        }

        .trip-details {
            margin-bottom: 35px;
        }

        .text-block {
            text-align: center;
            margin-bottom: 14px;
        }

        .trip-details p {
            text-align: left;
        }

        /* –°–∫—Ä—ã—Ç–∏–µ input –∏ —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è */
        .input-hidden {
            opacity: 0;
            position: absolute;
            pointer-events: none;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–∏—Å–ª–∞ –±–µ–∑ —Ä–∞–º–∫–∏ */
        .editable-number {
            display: inline-block;
            border-bottom: 1px dashed transparent;
        }

        .editable-number:hover {
            border-bottom-color: #000;
            cursor: pointer;
        }

        /* –ú–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ QR-–∫–æ–¥–∞ */
        @media (max-width: 767px) {
            .ticket__qrcode img,
            .ticket__qrcode canvas {
                height: 350px !important;
                width: 350px !important;
            }
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è toast-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        #toast {
            visibility: hidden;
            min-width: 250px;
            margin-left: -125px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 2px;
            padding: 16px;
            position: fixed;
            z-index: 1;
            left: 50%;
            bottom: 30px;
            font-size: 17px;
            transition: opacity 0.5s, bottom 0.5s;
            opacity: 0;
        }

        #toast.show {
            visibility: visible;
            opacity: 1;
            bottom: 50px;
        }

        body {
            position: relative;
        }

        .video-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1000;
            display: none;
            background-color: rgba(0, 0, 0, 0.7);
        }

        .video-container video {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 90%;
            max-height: 90%;
        }
    </style>

    <link rel="stylesheet" href="./style.css" media="all">
</head>

<body>
    <noscript>
        <div><img style="position:absolute; left:-9999px;" alt="" src="./95305900"></div>
    </noscript>
    
    <app-root ng-version="14.3.0">
        <router-outlet></router-outlet>
        <app-wrapper>
            <div class="wrapper">
                <app-header>
                    <header>
                        <h1 onclick="playVideo()">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ–ø–ª–∞—Ç–µ</h1>
                        <div class="video-container" id="videoContainer" style="display: none;">
                            <video id="payment-notification-video" controls>
                                <source src="" type="video/mp4">
                                –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
                            </video>
                        </div>
                    </header>
                </app-header>
                
                <div class="logo">
                    <img src="./logo.svg" alt="–°–∏—Å—Ç–µ–º–∞ –ë—ã—Å—Ç—Ä—ã—Ö –ü–ª–∞—Ç–µ–∂–µ–π">
                </div>
                
                <div class="content">
                    <router-outlet></router-outlet>
                    <app-result>
                        <div class="text-block text-block_text-align_center">
                            <p>–í–∞—à –ø—Ä–æ–µ–∑–¥ —É—Å–ø–µ—à–Ω–æ –æ–ø–ª–∞—á–µ–Ω!<br>–ß—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –±–∏–ª–µ—Ç–∞, –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É ¬´–°–∫–∞—á–∞—Ç—å –±–∏–ª–µ—Ç¬ª</p>
                        </div>
                        <app-ticket>
                            <div class="ticket">
                                <app-trip-details>
                                    <div class="trip-details text-block" id="trip-details">
                                        <p>–°–µ—Ä–∏—è –±–∏–ª–µ—Ç–∞: <strong id="ticket-series">QR2001</strong></p>
                                        <p>–ù–æ–º–µ—Ä –±–∏–ª–µ—Ç–∞: <strong id="ticket-number">20240715071131000</strong></p>
                                        <p>–î–∞—Ç–∞/–≤—Ä–µ–º—è –ø–æ–µ–∑–¥–∫–∏: <strong id="ticket-date-time"></strong></p>
                                        <p>
                                            <span id="bus-label" onclick="toggleTransport()">–ê–≤—Ç–æ–±—É—Å:</span>
                                            <strong class="editable-number" id="ticket-bus" onclick="editBus()">0</strong>
                                            <input type="number" id="input-ticket-bus" class="input-hidden" onblur="saveBus()">
                                        </p>
                                        <p>
                                            <span>–¢/–°:</span>
                                            <strong class="editable-number" id="ticket-tc" onclick="editTC()">0</strong>
                                            <input type="number" id="input-ticket-tc" class="input-hidden" onblur="saveTC()">
                                        </p>
                                        <p>
                                            –°—Ç–æ–∏–º–æ—Å—Ç—å:
                                            <strong class="editable-number" id="ticket-price" onclick="editPrice()">40.00 —Ä—É–±.</strong>
                                            <input type="text" id="input-ticket-price" class="input-hidden">
                                        </p>
                                    </div>
                                </app-trip-details>
                                
                                <div class="text-block text-block_text-align_center text-block_margin-bottom_14">
                                    <p onclick="resetTimer()">–° –º–æ–º–µ–Ω—Ç–∞ –æ–ø–ª–∞—Ç—ã –ø—Ä–æ—à–ª–æ:<br><strong id="time-since-payment">00:00:00</strong></p>
                                </div>
                                
                                <div class="text-block text-block_text-align_center">
                                    <p>QR-–∫–æ–¥ –±–∏–ª–µ—Ç–∞ –¥–ª—è –ø—Ä–µ–¥—ä—è–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä—É</p>
                                </div>
                                
                                <div class="ticket__qrcode">
                                    <img src="./qrcode.png" alt="QR-–∫–æ–¥ –±–∏–ª–µ—Ç–∞" style="height: 2000px; width: 2000px;" aria-label="url" title="–ë–∏–ª–µ—Ç">
                                </div>
                                
                                <div class="ticket__button">
                                    <app-button>
                                        <div class="for-button">
                                            <button class="for-button__button" onclick="showToast('–û—à–∏–±–∫–∞')">–°–∫–∞—á–∞—Ç—å –±–∏–ª–µ—Ç</button>
                                        </div>
                                        <div class="footer-text">v1.2 by doycs</div>
                                    </app-button>
                                </div>
                            </div>
                        </app-ticket>
                    </app-result>
                </div>
            </div>
        </app-wrapper>
    </app-root>

    <div id="toast">–û—à–∏–±–∫–∞</div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            function updateTime() {
                const now = new Date();
                const options = { year: 'numeric', month: 'numeric', day: 'numeric', hour: 'numeric', minute: 'numeric', timeZone: 'Europe/Moscow' };
                const formattedDate = now.toLocaleDateString('ru-RU', options).replace(',', '');
                document.getElementById('ticket-date-time').textContent = formattedDate;
            }

            function generateRandomNumber(min, max) {
                return Math.floor(Math.random() * (max - min + 1)) + min;
            }

            function updateTicket() {
                const randomTwoDigit = generateRandomNumber(1, 79).toString().padStart(2, '0');
                const randomThreeDigit = generateRandomNumber(11, 800).toString().padStart(3, '0');
                const now = new Date();
                const year = now.getFullYear();
                const month = ('0' + (now.getMonth() + 1)).slice(-2);
                const day = ('0' + now.getDate()).slice(-2);
                const randomDigits = generateRandomNumber(100000, 999999);
                const ticketNumber = year + month + day + randomDigits + '000';
                
                document.getElementById('ticket-series').textContent = 'QR2001' + randomTwoDigit + '000' + randomThreeDigit;
                document.getElementById('ticket-number').textContent = ticketNumber;
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            updateTime();
            updateTicket();
            setInterval(updateTime, 1000 * 60); // –ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
            setInterval(updateTicket, 24 * 60 * 60 * 1000); // –ö–∞–∂–¥—ã–µ 24 —á–∞—Å–∞
        });

        function editBus() {
            toggleEditVisibility('ticket-bus', 'input-ticket-bus');
        }

        function editTC() {
            toggleEditVisibility('ticket-tc', 'input-ticket-tc');
        }

        function editPrice() {
            toggleEditVisibility('ticket-price', 'input-ticket-price', ' —Ä—É–±.');
        }

        function toggleEditVisibility(textId, inputId, suffix = '') {
            const textElement = document.getElementById(textId);
            const inputElement = document.getElementById(inputId);

            inputElement.value = textElement.textContent.replace(suffix, '');
            textElement.style.display = 'none';
            inputElement.style.display = 'inline-block';
            inputElement.focus();
        }

        function saveValue(textId, inputId, suffix = '') {
            const textElement = document.getElementById(textId);
            const inputElement = document.getElementById(inputId);
            const newValue = inputElement.value.trim();

            if (newValue !== '' && !isNaN(newValue)) {
                textElement.textContent = newValue + suffix;
            }

            inputElement.style.display = 'none';
            textElement.style.display = 'inline-block';
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Ñ–æ–∫—É—Å–∞
        document.getElementById('input-ticket-bus').addEventListener('blur', () => saveValue('ticket-bus', 'input-ticket-bus'));
        document.getElementById('input-ticket-tc').addEventListener('blur', () => saveValue('ticket-tc', 'input-ticket-tc'));
        document.getElementById('input-ticket-price').addEventListener('blur', () => saveValue('ticket-price', 'input-ticket-price', ' —Ä—É–±.'));

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');

            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        function toggleTransport() {
            const busLabel = document.getElementById("bus-label");
            busLabel.textContent = busLabel.textContent === "–ê–≤—Ç–æ–±—É—Å:" ? "–¢—Ä–æ–ª–ª–µ–π–±—É—Å:" : "–ê–≤—Ç–æ–±—É—Å:";
        }

        let seconds = 0; 

        function resetTimer() {
            seconds = 0; 
            updateTimer(); 
        }

        function updateTimer() {
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const remainingSeconds = seconds % 60;

            const timeString = 
                (hours < 10 ? "0" : "") + hours + ":" + 
                (minutes < 10 ? "0" : "") + minutes + ":" + 
                (remainingSeconds < 10 ? "0" : "") + remainingSeconds;

            document.getElementById("time-since-payment").textContent = timeString;
            seconds++; 
        }

        setInterval(updateTimer, 1000); 

        function playVideo() {
            const videoContainer = document.getElementById("videoContainer");
            const video = document.getElementById("payment-notification-video");
    
            const randomVideoIndex = Math.floor(Math.random() * 5) + 1; 
            video.src = `${randomVideoIndex}.mp4`;
    
            videoContainer.classList.add('fullscreen');
    
            videoContainer.style.display = "flex"; 
            video.play();
    
            videoContainer.addEventListener('click', function() {
                video.pause();
                videoContainer.classList.remove('fullscreen');
                videoContainer.style.display = 'none';
            });
        }
    </script>

    <style>
        .show {
            display: block;
        }
        .input-hidden {
            display: none;
        }
    </style>
</body>

<!-- 

–¢–∞–∫, –ï–ë–ê–¢–¨ 
–í–æ-–ø–µ—Ä–≤—ã—Ö, –∑–∞—á–µ–º —Ç—ã —Å—é–¥–∞ –∑–∞—à–µ–ª?
–í–æ-–≤—Ç–æ—Ä—ã—Ö, —Å–∫–∞–∂–∏ —Å–ø–∞—Å–∏–±–æ —Å–æ–∑–¥–∞—Ç–µ–ª—é, —á—Ç–æ —ç–∫–æ–Ω–æ–º–∏—à—å —Å–≤–æ–∏ –∫–æ–ø–µ–π–∫–∏ –µ–±–∞–Ω—ã–µ.
–í-—Ç—Ä–µ—Ç—å–∏—Ö –Ω–µ –ø–∏–∑–¥–∏ —Å–∞–π—Ç –ø–∂–ø–∂–ø–∂.

devblog v2.0 ZOVüá∫üá¶:
    –ø–æ—á–∏—â–µ–Ω –∫–æ–¥ –æ—Ç —Ö—É–π–Ω–∏.
    —Å—Ç–∞—Ä—Ç/–æ–±–Ω—É–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞ –ø–æ –Ω–∞–∂–∞—Ç–∏—é.
    —É–ª—É—á—à–µ–Ω qr-–∫–æ–¥.
    –¥–æ–±–∞–≤–ª–µ–Ω—ã 5 –∑–∞–±–∞–≤–Ω—ã—Ö *.mp4.
    –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –±–∞–≥–∏ –≤—Ä–µ–º–µ–Ω–∏.

info:
    dev @zxchoxxy
    –ø–æ–¥–ø–∏—Å–∫–∞ –≤ –º–µ—Å—è—Ü 350—Ä—É–±.

-->